<!DOCTYPE html>
<html>
<head>
	<title>Ping Pong Game</title>
	<style> canvas {position:fixed; width: 100%; height: 100%;} </style>
</head>
<body>
	<canvas id="canvas" width="800" height="400"></canvas>
	<script type="text/javascript" src="js/app.js"></script>
	<script type="text/javascript">
		//Sample functions, remove these functions and design ping-pong game with onInit and onUpdate.


		let leftPlayerDown=false;
		let leftPlayerUp=false;
		let rightPlayerDown=false;
		let rightPlayerUp=false;
		let paused= false;
		let started=false;


		app.onInit = function(){
			this.canvas=document.getElementById("canvas");

			
			this.nodes.push({
				id:"left-player",
				x: (this.canvas.width / 32),
				y: (this.canvas.height / 2) - 35,
				width: canvas.width * 0.01,
				height: canvas.height * 0.2,
				color: "green",
			});

			this.nodes.push({
				id: "right-player",
				x: this.canvas.width - (this.canvas.width / 22),
				y: (this.canvas.height / 2) - 35,
				width: canvas.width * 0.01,
				height: canvas.height * 0.2,
				color: "green",
			});
			this.nodes.push({
				id: "ball",
				x: canvas.width / 2,
				y: canvas.height / 2,
				width: this.getNode("left-player").width,
				height: this.getNode("left-player").width,
				color: "green",
				xDirSpeed: Math.random()<0.5?(Math.floor(Math.random()* 3)+1) : -(Math.floor(Math.random()*3)+1),
				yDirSpeed: Math.random()<0.5?(Math.floor(Math.random()* 3)+1) : -(Math.floor(Math.random()*3)+1),

			});


			function restart(){
				ball.x = canvas.width
			}


		document.addEventListener("keydown", (e) => {
				if(e.keyCode==32){
					app.pause();
				
				}
				if(e.keyCode==82){
					app.restart();
				
				}
				if(e.keyCode==87){
					this.getNode("left-player").y -= 17;
				
				}if(e.keyCode==83){
					this.getNode("left-player").y += 17;

				}if(e.keyCode==38){
					this.getNode("right-player").y -= 17;

				}if(e.keyCode==40){
					this.getNode("right-player").y += 17;

				}
        });

        document.addEventListener("keyup", (e) => {
			leftPlayerUp=false;
			leftPlayerDown=false;
			rightPlayerUp=false;
			rightPlayerDown=false;
        });

		app.updateBall= function(){
		this.getNode("ball").x += this.getNode("ball").xDirSpeed;
		this.getNode("ball").y += this.getNode("ball").yDirSpeed;

			
		if (this.getNode("ball").y <=0) { //hitting the bottom wall
			this.getNode("ball").y = 1
		} 
		if (this.getNode("ball").y >= this.canvas.height - this.getNode("ball").height) { //hitting the top wall
			this.getNode("ball").y = this.canvas.height - this.getNode("ball").height -1
		}
		//move the ball
		// if (!paused){
		// 	this.getNode("ball").
		// }

		
		};

		app.onUpdate = function(time){
			this.getNode('black-box').y++;

			if(Math.cos(this.timestamp / 100) > 0){
				this.getNode('red-box').direction = -1;
			}else{
				this.getNode('red-box').direction = 1;
			}

			this.getNode('red-box').x+=this.getNode('red-box').direction;

			

		};

		function loop(){
			app.updateBall();
			requestAnimationFrame(app.onInit);

		}
		loop();
	};
	</script>
</body>
</html>